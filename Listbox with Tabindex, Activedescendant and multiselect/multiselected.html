<!DOCTYPE html>
<html lang="en">
<head>
    <title>listbox</title>
</head>
<style>
    .listbox-item[aria-selected="true"] {
        background-color: #ddd;
        border-color: rgb(0, 0, 0);
        border-width: 2px;
        border-style: solid;
        width: 10cm;
    }
    .listbox-item {
        padding: 10px;
    }
    .listbox :focus {
        width: 5cm;
    }
    .main-content :focus{
        width: 10cm;
    }
</style>
<body>
    <div class="multiselected">
        <h2>Listbox with Activedescendant</h2>
        <label for="listbox" id="listbox-label"><b>Add User:</b></label><br>
        <div class="main-content">
            <div class="listbox" role="listbox" aria-labelledby="states" aria-activedescendant="">
                <div id="state1" class="listbox-item" role="option" aria-selected="false" tabindex="0">Rahul.B</div>

                <div id="state2" class="listbox-item" role="option" aria-selected="false" tabindex="0">Anant.P</div>

                <div id="state3" class="listbox-item" role="option" aria-selected="false" tabindex="0">Suraj.P</div>

                <div id="state4" class="listbox-item" role="option" aria-selected="false" tabindex="0">Madhav.S</div>

                <div id="state5" class="listbox-item" role="option" aria-selected="false" tabindex="0">Gaurav.A</div>

                <div id="state6" class="listbox-item" role="option" aria-selected="false" tabindex="0">Krushana.K</div>
            </div>
        </div>
    </div>
    <script>
        let listbox = document.querySelector('.listbox');
        let items = Array.from(listbox.children);
        listbox.setAttribute('role', 'listbox');
        listbox.setAttribute('tabindex', '0');
        listbox.setAttribute('aria-labelledby', 'listbox-label');

        listbox.addEventListener('keydown', e => {
        let currentIndex = items.findIndex(item => item === document.activeElement);

        if (e.key === 'ArrowUp' && currentIndex > 0) {
            e.preventDefault();
            items[currentIndex - 1].focus();
        }
        if (e.key === 'ArrowDown' && currentIndex < items.length - 1) {
            e.preventDefault();
            items[currentIndex + 1].focus();
        }
        if (e.key === ' ' || e.key === 'Enter') {
            e.preventDefault();
            toggleSelection(document.activeElement);
        }
        });

        listbox.addEventListener('click', e => {
        let clickedItem = e.target;
        if (clickedItem.classList.contains('listbox-item')) {
            toggleSelection(clickedItem);
        }
        });

        function toggleSelection(item) {
        let isSelected = item.getAttribute('aria-selected') === 'true';

        if (isSelected) {
            item.setAttribute('aria-selected', 'false');
        } else {
            item.setAttribute('aria-selected', 'true');
        }
        }
    </script>
</body>
</html>